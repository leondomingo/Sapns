<div class="sp_app_title">{{tg.config.get('app.name', 'Sapns')}}
    <span class="sp_app_title_sep">::</span>
    <span class="sp_app_subtitle">{{tg.config.get('app.subtitle', 'Web Information System')}}</span></div>

<!--{% if request.identity %}-->
    {% include 'sapns/logout.html' %}

    <script>
    function _close_options(callback) {
        $('#sp-user-menu').fadeOut('fast');
        if (callback) {
            callback();
        }
    }
    
    $(function() {
        $('.sp-logout-user').click(function() {
            if ($('#sp-user-menu').is(':visible')) {
                _close_options();
            }
            else {
                $('#sp-user-menu').fadeIn('slow');
            }
        });
        
        $('.sp-logout-btn').click(function() {
            window.location = "{{tg.url('/logout_handler')}}";
        });
    });
</script>
<!--{% else %}-->
<style>
#language_selector { float:right; margin-top:5px }
</style>
<select id="language_selector">
    <option value="">{{_('Select your language')}}</option>
    <!--{% if not languages %}-->
    <option value="en" {% if lang == 'en' %} selected {% endif %}>English</option>
    <option value="es" {% if lang == 'es' %} selected {% endif %}>Espa√±ol</option>
    <!--{% else %}-->
    <!--{% for l in languages %}-->
    <option value="{{l.code}}" {% if lang == l.code %} selected {% endif %}>{{l.name}}</option>
    <!--{% endfor %}-->
    <!--{% endif %}-->
    <!-- rest of languages -->
</select>
<script>
    $(function() {
        $('#language_selector').change(function() {
            var _lang = $(this).val();
            if (_lang) {
                $.ajax({
                    url: "{{tg.url('/setlang')}}",
                    data: { lang: $('#language_selector option:selected').val() },
                    success: function() {
                        window.location.reload();
                    }
                });
            }
        });
    });
</script>
<!--{% endif %}-->