<div class="sp_logout">
    <div class="sp-logout-user" title="{{request.identity.user.user_name}}">
        <a>{{request.identity.user.display_name}}</a>
    </div>
    <div class="sp-logout-btn">
        <a title="{{_('Click here to logout')}}">{{_('logout')}}</a>
    </div>
    
    <div id="sp-user-menu">
        <!-- TODO: automatically generated -->
        <div class="sp-user-option" id="sp-user-data">{{_('User data')}}</div>
        <div class="sp-user-option" id="sp-user-views">{{_('User views')}}</div>
        <div class="sp-user-option">
        {% include 'sapns/lang_selector.html' %}
        </div>
    </div>
</div>

<script>
$(function() {
    $('#sp-user-data').click(function() {
        var f = '<form action="{{tg.url("/dashboard/users/edit/_/%d" % tg.request.identity["user"].user_id)}}">\
            <input type="hidden" name="came_from" value="' + encodeURI(window.location.href) + '">\
        </form>';
        
        $(f).appendTo('body').submit().remove();
    });
    
    $('#sp-user-views').click(function() {
        var f = '<form action="{{tg.url("/dashboard/views/")}}">\
            <input type="hidden" name="came_from" value="' + encodeURI(window.location.href) + '">\
        </form>';
        
        $(f).appendTo('body').submit().remove();
    });
});
</script>