function load_script(b){var a=document.createElement("script");a.setAttribute("type","text/javascript");
a.setAttribute("src",b);document.getElementsByTagName("head")[0].appendChild(a)}try{sprintf
}catch(e){load_script("{{tg.url('/js/sprintf.min.js')}}")}(function(b){function a(c){function d(f,g,h,i){if(i==undefined){i=c
}if(i[g]==undefined){f[g]=h}else{f[g]=i[g]}return}d(this,"name","sel_"+Math.floor(Math.random()*999999));
d(this,"value","");d(this,"title","");d(this,"rc","");d(this,"rc_title","");d(this,"read_only",false);
d(this,"title_url","{{tg.url('/dashboard/title/')}}");d(this,"search_url","{{tg.url('/dashboard/search/')}}");
d(this,"search_params",null);d(this,"edit_url","{{tg.url('/dashboard/edit/')}}");
d(this,"onChange",null);d(this,"onClick",null);d(this,"dialog",{});d(this.dialog,"width",1100,this.dialog);
d(this.dialog,"height",600,this.dialog);d(this.dialog,"results",25,this.dialog)}a.prototype.setValue=function(g,f){var d=this;
if(!d.read_only){var h=d.value!=g;var c=d.value;d.value=g;if(h&&d.onChange&&!f){d.onChange(g,c)
}}};a.prototype.getValue=function(){return this.value};a.prototype.setTitle=function(){var c=this;
var f="#st_"+c.name;var d=c.value;if(d&&c.rc){b.ajax({url:c.title_url,data:{cls:c.rc,id:c.value},success:function(g){if(g.status){b(f).val(g.title).parent().attr("value",d);
c.title=g.title}}})}else{b(f).val("").parent().attr("value","");c.title=""}};a.prototype.getTitle=function(){return this.title
};a.prototype.getClass=function(){return this.rc};a.prototype.search=function(d){var c=this;
var g="#dialog_"+c.name;if(d==undefined){d=b(g+" .sp-search-text").val()}var f={cls:c.rc,q:d,rp:c.dialog.results};
if(c.search_params!=null){if(typeof(c.search_params)=="object"){f=b.extend(true,f,c.search_params)
}else{if(typeof(c.search_params)=="function"){f.search_params=c.search_params;f.search_params()
}}}b.ajax({url:this.search_url,dataType:"html",data:f,success:function(h){b(g).html(h)
},error:function(j,h,i){alert("error!");sapnsSelector.search()}})};a.prototype.search_kp=function(c){if(c.which==13){this.search()
}};a.prototype.remove=function(){this.setValue("");this.setTitle()};a.prototype.setReadonly=function(d){var c=this;
if(d===undefined){d=true}b("#st_"+c.name).attr("disabled",d);b("#sb_"+c.name).attr("disabled",d);
b("#rb_"+c.name).attr("disabled",d);c.read_only=d};b.fn.sapnsSelector=function(g,f,d){if(typeof(g)=="object"){var i=new a(g);
this.append('<div id="dialog_'+i.name+'" style="display: none;"></div>');var k='<input id="st_'+i.name+'" class="sp-select-text" type="text" readonly value=""';
if(this.attr("readonly")||this.attr("disabled")){i.read_only=true}if(i.read_only){k+=" disabled"
}k+=">";this.append(k);this.find("#st_"+i.name).dblclick(function(){if(!i.isReadonly){var m=i.getClass();
var o=i.getValue();if(o!=""){var l=i.edit_url;if(l[l.length-1]!="/"){l+="/"}l+=sprintf("%s/%s",m,o);
var n='<form action="'+l+'" method="post" target="_blank"><input type="hidden" name="came_from" value=""></form>';
b(n).appendTo("body").submit().remove()}}});var j=sprintf('{{_("Set a value for [%s]")}}',i.title);
var c='<button id="sb_'+i.name+'" class="sp-select-button"  title="'+j+'"';if(i.read_only){c+=" disabled"
}c+=">...</button>";this.append(c);this.find("#sb_"+i.name).click(function(){if(!i.isReadonly){if(i.onClick){i.onClick(i.value)
}else{var l=i.rc_title;if(typeof(i.rc_title)=="function"){l=i.rc_title()}b("#dialog_"+i.name).dialog({title:l,width:i.dialog.width,height:i.dialog.height,resizable:false,modal:true,buttons:{"{{_('Ok')}}":function(){var m=b("#dialog_"+i.name+" .sapns_grid").sapnsGrid("getSelectedIds")[0];
i.setValue(m);i.setTitle();b("#dialog_"+i.name).dialog("close")},"{{_('Cancel')}}":function(){b("#dialog_"+i.name).dialog("close")
}}});i.search("")}}});i.setTitle();var h='<button id="rb_'+i.name+'" class="sp-empty-button"';
if(i.read_only){h+=" disabled "}var j=sprintf("{{_('Remove value of [%s]')}}",i.title);
h+=' title="'+j+'">x</button>';this.append(h);this.find("#rb_"+i.name).click(function(){if(!i.isReadonly){i.remove()
}});this.data("sapnsSelector",i)}else{if(typeof(g)=="string"){var i=this.data("sapnsSelector");
if(g=="setValue"){i.setValue(f,d);i.setTitle()}else{if(g=="getValue"){return i.value
}else{if(g=="getTitle"){return i.title}else{if(g=="getClass"){return i.rc}else{if(g=="setReadonly"){i.setReadonly(f)
}else{if(g=="isReadonly"){return i.read_only}}}}}}}}return this}})(jQuery);