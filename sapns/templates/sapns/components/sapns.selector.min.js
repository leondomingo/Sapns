function load_script(b){var a=document.createElement("script");a.setAttribute("type","text/javascript");
a.setAttribute("src",b);document.getElementsByTagName("head")[0].appendChild(a)}try{sprintf
}catch(e){load_script("{{tg.url('/js/sprintf.min.js')}}")}(function(b){function a(c){function d(f,g,h,i){if(i===undefined){i=c
}if(i[g]===undefined){f[g]=h}else{f[g]=i[g]}return}d(this,"name","sel_"+Math.floor(Math.random()*999999));
d(this,"value","");d(this,"title","");d(this,"rc","");d(this,"rc_title","");d(this,"read_only",false);
d(this,"title_url","{{tg.url('/dashboard/title/')}}");d(this,"search_url","{{tg.url('/dashboard/search/')}}");
d(this,"search_params",null);d(this,"edit_url","{{tg.url('/dashboard/edit/')}}");
d(this,"onChange",null);d(this,"onClick",null);d(this,"dialog",{});d(this.dialog,"width",1100,this.dialog);
d(this.dialog,"height",600,this.dialog);d(this.dialog,"results",25,this.dialog)}a.prototype.setValue=function(g,f){var d=this;
if(!d.read_only){var h=d.value!=g;var c=d.value;d.value=g;if(h&&d.onChange&&!f){d.onChange(g,c)
}}};a.prototype.getValue=function(){return this.value};a.prototype.setTitle=function(){var c=this;
var f="#st_"+c.name;var d=c.value;if(d&&c.rc){b.ajax({url:c.title_url,data:{cls:c.rc,id:c.value},success:function(g){if(g.status){b(f).val(g.title).parent().attr("value",d);
c.title=g.title}}})}else{b(f).val("").parent().attr("value","");c.title=""}};a.prototype.getTitle=function(){return this.title
};a.prototype.getClass=function(){return this.rc};a.prototype.search=function(d){var c=this;
if(d===undefined){d=b(c.dialog_name()+" .sp-search-text").val()}var f={cls:c.rc,q:d,rp:c.dialog.results};
if(c.search_params!=null){if(typeof(c.search_params)==="object"){f=b.extend(true,f,c.search_params)
}else{if(typeof(c.search_params)==="function"){f.search_params=c.search_params;f.search_params()
}}}b.ajax({url:this.search_url,dataType:"html",data:f,success:function(g){b(c.dialog_name()).html(g)
},error:function(i,g,h){alert("error!");sapnsSelector.search()}})};a.prototype.search_kp=function(c){if(c.which===13){this.search()
}};a.prototype.remove=function(){this.setValue("");this.setTitle()};a.prototype.setReadonly=function(d){var c=this;
if(d===undefined){d=true}b("#st_"+c.name).attr("disabled",d);b("#sb_"+c.name).attr("disabled",d);
b("#rb_"+c.name).attr("disabled",d);c.read_only=d};a.prototype.dialog_name=function(){var c=this;
return"#sp-selector-dialog-"+c.name};b.fn.sapnsSelector=function(g,f,d){if(typeof(g)==="object"){var l=this;
var h=new a(g);var c='<input id="st_'+h.name+'" class="sp-select-text" type="text" readonly value=""';
if(l.attr("readonly")||l.attr("disabled")){h.read_only=true;c+=" disabled"}c+=">";
l.append(c);l.find("#st_"+h.name).dblclick(function(){if(!h.isReadonly){var n=h.getClass();
var p=h.getValue();if(p!=""){var m=h.edit_url;if(m[m.length-1]!="/"){m+="/"}m+=sprintf("%s/%s",n,p);
var o='<form action="'+m+'" method="post" target="_blank"><input type="hidden" name="came_from" value=""></form>';
b(o).appendTo("body").submit().remove()}}});var j=sprintf('{{_("Set a value for [%s]")}}',h.title);
var i='<button id="sb_'+h.name+'" class="sp-select-button"  title="'+j+'"';if(h.read_only){i+=" disabled"
}i+=">...</button>";l.append(i);l.find("#sb_"+h.name).click(function(){if(!h.isReadonly){if(h.onClick){h.onClick(h.value)
}else{var n=h.rc_title;if(typeof(h.rc_title)==="function"){n=h.rc_title()}var m=h.dialog_name().replace("#","");
b(h.dialog_name()).remove();b('<div id="'+m+'"></div>').appendTo("body");b(h.dialog_name()).dialog({title:n,width:h.dialog.width,height:h.dialog.height,resizable:false,modal:true,buttons:{"{{_('Ok')}}":function(){var o=b(h.dialog_name()+" .sapns_grid").sapnsGrid("getSelectedIds")[0];
h.setValue(o);h.setTitle();b(h.dialog_name()).dialog("destroy").remove()},"{{_('Cancel')}}":function(){b(h.dialog_name()).dialog("destroy").remove()
}}});h.search("")}}});h.setTitle();var k='<button id="rb_'+h.name+'" class="sp-empty-button"';
if(h.read_only){k+=" disabled "}var j=sprintf("{{_('Remove value of [%s]')}}",h.title);
k+=' title="'+j+'">x</button>';this.append(k);this.find("#rb_"+h.name).click(function(){if(!h.isReadonly){h.remove()
}});this.data("sapnsSelector",h)}else{if(typeof(g)==="string"){var h=this.data("sapnsSelector");
if(g==="setValue"){h.setValue(f,d);h.setTitle()}else{if(g==="getValue"){return h.value
}else{if(g==="getTitle"){return h.title}else{if(g==="getClass"){return h.rc}else{if(g==="setReadonly"){h.setReadonly(f)
}else{if(g==="isReadonly"){return h.read_only}}}}}}}}return this}})(jQuery);