function load_script(b){var a=document.createElement("script");a.setAttribute("type","text/javascript");
a.setAttribute("src",b);document.getElementsByTagName("head")[0].appendChild(a)}try{sprintf
}catch(e){load_script("{{tg.url('/js/sprintf.min.js')}}")}(function(b){function a(c){function d(f,g,h,i){if(i===undefined){i=c
}if(i[g]===undefined){f[g]=h}else{f[g]=i[g]}return}d(this,"name","sel_"+Math.floor(Math.random()*999999));
d(this,"value","");d(this,"title","");d(this,"rc","");d(this,"rc_title","");d(this,"read_only",false);
d(this,"title_url","{{tg.url('/dashboard/title/')}}");d(this,"search_url","{{tg.url('/dashboard/search/')}}");
d(this,"search_params",null);d(this,"edit_url","{{tg.url('/dashboard/edit/')}}");
d(this,"onChange",null);d(this,"onClick",null);d(this,"dialog",{});d(this.dialog,"width",1100,this.dialog);
d(this.dialog,"height",600,this.dialog);d(this.dialog,"results",25,this.dialog)}a.prototype.setValue=function(g,f){var d=this;
if(!d.read_only){var h=d.value!=g,c=d.value;d.value=g;if(h&&d.onChange&&!f){d.onChange(g,c)
}}};a.prototype.getValue=function(){return this.value};a.prototype.setTitle=function(){var c=this,f="#st_"+c.name,d=c.value;
if(d&&c.rc){b.ajax({url:c.title_url,data:{cls:c.rc,id:c.value},success:function(g){if(g.status){b(f).val(g.title).parent().attr("value",d);
c.title=g.title}}})}else{b(f).val("").parent().attr("value","");c.title=""}};a.prototype.getTitle=function(){return this.title
};a.prototype.getClass=function(){return this.rc};a.prototype.search=function(d){var c=this;
if(d===undefined){d=b(c.dialog_name()+" .sp-search-text").val()}var f={cls:c.rc,q:d,rp:c.dialog.results};
if(c.search_params!=null){if(typeof(c.search_params)==="object"){f=b.extend(true,f,c.search_params)
}else{if(typeof(c.search_params)==="function"){f.search_params=c.search_params;f.search_params()
}}}b.ajax({url:this.search_url,dataType:"html",data:f,success:function(g){b(c.dialog_name()).html(g)
},error:function(i,g,h){alert("error!");sapnsSelector.search()}})};a.prototype.search_kp=function(c){if(c.which===13){this.search()
}};a.prototype.remove=function(){this.setValue("");this.setTitle()};a.prototype.setReadonly=function(d){var c=this;
if(d===undefined){d=true}b("#st_"+c.name).attr("disabled",d);b("#sb_"+c.name).attr("disabled",d);
b("#rb_"+c.name).attr("disabled",d);c.read_only=d};a.prototype.dialog_name=function(){var c=this;
return"#sp-selector-dialog-"+c.name};b.fn.sapnsSelector=function(h,g,f){if(typeof(h)==="object"){var m=this,i=new a(h),c='<input id="st_'+i.name+'" class="sp-select-text" type="text" readonly value=""';
if(m.attr("readonly")||m.attr("disabled")){i.read_only=true;c+=" disabled"}c+=">";
m.append(c);m.find("#st_"+i.name).dblclick(function(){if(!i.isReadonly){var o=i.getClass(),q=i.getValue();
if(q!=""){var n=i.edit_url;if(n[n.length-1]!="/"){n+="/"}n+=sprintf("%s/%s",o,q);
var p='<form action="'+n+'" method="post" target="_blank">                                <input type="hidden" name="came_from" value="">                            </form>';
b(p).appendTo("body").submit().remove()}}});var k="{{_('Set value')}}",j='<button id="sb_'+i.name+'" class="sp-select-button" title="'+k+'"';
if(i.read_only){j+=" disabled"}j+=">...</button>";m.append(j);m.find("#sb_"+i.name).click(function(){if(!i.isReadonly){if(i.onClick){i.onClick(i.value)
}else{var o=i.rc_title;if(typeof(i.rc_title)==="function"){o=i.rc_title()}var n=i.dialog_name().replace("#","");
b(i.dialog_name()).remove();b('<div id="'+n+'"></div>').appendTo("body");b(i.dialog_name()).dialog({title:o,width:i.dialog.width,height:i.dialog.height,resizable:false,modal:true,buttons:{"{{_('Ok')}}":function(){var q=b(i.dialog_name()+" .sapns_grid").sapnsGrid("getSelectedIds")[0],p=i.getValue();
i.setValue(q);if(p!=q){i.setTitle()}b(i.dialog_name()).dialog("destroy").remove()
},"{{_('Cancel')}}":function(){b(i.dialog_name()).dialog("destroy").remove()}}});
i.search("")}}});i.setTitle();var l='<button id="rb_'+i.name+'" class="sp-empty-button"',k="{{_('Remove value')}}";
if(i.read_only){l+=" disabled "}l+=' title="'+k+'">x</button>';this.append(l);this.find("#rb_"+i.name).click(function(){if(!i.isReadonly){i.remove()
}});this.data("sapnsSelector",i)}else{if(typeof(h)==="string"){var i=this.data("sapnsSelector");
if(h==="setValue"){var d=i.getValue();i.setValue(g,f);if(d!=g){i.setTitle()}}else{if(h==="getValue"){return i.value
}else{if(h==="getTitle"){return i.title}else{if(h==="getClass"){return i.rc}else{if(h==="setReadonly"){i.setReadonly(g)
}else{if(h==="isReadonly"){return i.read_only}}}}}}}}return this}})(jQuery);