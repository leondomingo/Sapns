<script type="text/javascript">
    $(document).ready(function() {
    	// delete
    	$('.sc_delete_button').click(function() {
    		var sc = $(this).parent().parent().parent();
    		var sc_id = sc.attr('sc_id');
    		
            $('#delete-confirmation').
            dialog({
                resizable: false,
                height: 150,
                width: 300,
                modal: true,
                buttons: {
                    "{{_('Ok')}}": function() {
                    	$.ajax({
                    		url: "{{tg.url('/sc/delete')}}",
                    		type: 'post',
                    		dataType: 'json',
                    		data: {
                    			id: sc_id,
                    		},
                    		success: function(res) {
                    			sc.fadeOut();
                    			$('#delete-confirmation').dialog('close');
                    		},
                    		error: function() {
                    			alert('Error!');
                    			$('#delete-confirmation').dialog('close');
                    		}
                    	});
                    },
                    "{{_('Cancel')}}": function() {
                    	$('#delete-confirmation').dialog('close');
                    }
                }
            });
    	});
    	
    	// bookmark
    	$('.sc_bookmark_button').click(function() {
    		var sc = $(this).parent().parent().parent();
            var sc_id = sc.attr('sc_id');
            
            $('#bookmark-confirmation').dialog({
                resizable: false,
                height: 150,
                width: 300,
                modal: true,
                buttons: {
                    "Ok": function() { 
                        $.ajax({
                            url: "{{tg.url('/sc/bookmark')}}",
                            type: 'post',
                            dataType: 'json',
                            data: {
                                id: sc_id,
                            },
                            success: function(res) {
                                sc.effect('highlight', {color: 'red'}, 400);
                                $('#bookmark-confirmation').dialog('close');
                            },
                            error: function() {
                                alert('Error!');
                                $('#bookmark-confirmation').dialog('close');
                            }
                        });
                    },
                    "Cancel": function() { 
                    	$('#bookmark-confirmation').dialog('close');
                    }
                }
            });
        });
    });
</script>

<div id="delete-confirmation" style="display: none;" title="{{_('Delete shortcut')}}">
  {{_('Do you want to delete this shortcut?')}}
</div>

<div id="bookmark-confirmation" style="display: none;" title="{{_('Bookmark shortcut')}}">
  {{_('Do you want to bookmark this shortcut?')}}
</div>

<div>
    {% for sc in shortcuts %}
    <div class="sp_shortcut" sc_id="{{sc.id}}"">
    {% if sc.action_type %}
        {% if sc.action_type == 'list' %}
            <div style="height: 24px; {% if loop.index % 2 == 0 %}background-color: white;{%endif%}">
            <div class="sp_shortcut_title">
            <a href="{{tg.url('/list', cls=sc.cls, came_from='/?sc_parent=%d' % sc.parent)}}">
                {{sc.title}}</a>
            </div>
            
            <!-- actions over shortcuts -->
            
            <!-- insertion order -->
            <div class="sp_shortcut_insertion_order">
            <a href="{{tg.url('/ins_order', cls=sc.cls, came_from='/?sc_parent=%d' % sc.parent)}}">
                {{_('Insertion order')}}
            </a>
            </div>
            
            <!-- reference order -->
            <div class="sp_shortcut_reference_order">
            <a href="{{tg.url('/ref_order', cls=sc.cls, came_from='/?sc_parent=%d' % sc.parent)}}">
                {{_('Reference order')}}
            </a>
            </div>
            
            <!-- Edit -->
            <div>
                <form method="post" action="/sc/edit">
                <input type="hidden" name="id" value="{{sc.id}}"/>
                <input type="hidden" name="came_from" value="{{'/?sc_parent=%d' % sc.parent}}"/>
                <input class="sp_button" style="width: 90px; float: left;" 
                    type="submit" value="{{_('Edit')}}"/>
                </form>
            </div>
            
            <!-- Delete -->
            <div>
                <input class="sp_button sc_delete_button" style="width: 90px; float: left;" 
                    type="button" value="{{_('Delete')}}"/>
            </div>

            <!-- Bookmark this -->
            <div>
                <input class="sp_button sc_bookmark_button" style="width: 90px; float: left;" 
                    type="button" value="{{_('Bookmark this')}}"/>
            </div>
            
            </div>
        {% else %}
            <a href="{{tg.url(sc.url)}}">{{sc.title}}</a>
        {% endif %}
    {% else %}
        {# This is a group #}
        <a href="{{tg.url('/', sc_parent=sc.id)}}">{{sc.title}}</a>
    {% endif %}
    </div>
    {% endfor %}
</div>