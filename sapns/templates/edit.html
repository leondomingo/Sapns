{% extends 'base.html' %}

{% block middle %}

{% import 'util.html' as util %}
{{util.jquery()}}

<script type="text/javascript">
    $(document).ready(function() {
    	
    	$('#save_button').click(function() {
    		var params = '';
    		$('.sp_input_field').each(function(){
    			params += 
    				'<input type="hidden" ' + 
    			        'name="' + $(this).attr('name') + '" ' + 
    			        'value="' + $(this).val() + '"/>\n';
    		});
    		
    		//alert(params)
    		
    		//$('#edit_form').append(params).submit();
    		//alert($('#edit_form').html());
    	});
    });
</script>

<style type="text/css">
    .sp_edit_panel {
        overflow: auto;
    }
    
    .sp_save_button {
        position: fixed;
        right: 300px;
    }
    
    .sp_edit_field {
    }
    
    .sp_input_field {
        width: 97%;
        max-width: 97%;
        min-width: 97%;
        margin-left: 1%;
    }
    
    .sp_memo_field {
        min-height: 40px;
        height: 100px;
        /*font-family: Courier;*/
    }
</style>

<form id="edit_form" method="post" action="{{tg.url('/save')}}">
    <input type="hidden" name="cls" value="{{cls}}"/> 
    <input type="hidden" name="id" value="{{id}}"/>
</form>

<div class="sp_edit_panel">
    <div class="sp_save_button">
        <input id="save_button" class="sp_button" type="button" value="{{_('Save')}}"/>
    </div>
    
    <div style="font-size: 25px; margin-left: 1%;">
        {{cls}}
    </div>

    {% if reference %}
    <div style="margin-left: 1%; width: 97%; font-size: 15px; color: black; 
        background-color: none;">[{{reference}}]</div>
    {% endif %}
    
    <div style="height: 10px;">
    </div>
    
    {% for atr in attributes %}
    <div class="sp_edit_field">
        <div class="sp_label_field" 
            style="margin-left: 10px; 
                margin-top: 4px;
                margin-bottom: 2px;">{{atr.title|escape}}</div>
        <div>
        <!-- Boolean -->
        {% if atr.type == 'Boolean' %}
        <input class="sp_input_field" type="checkbox" name="{{atr.name}}"
            {% if atr.value %}checked="checked"{% endif %}/>
        {% elif atr.type == 'String' %}
        <textarea class="sp_input_field sp_memo_field" name="{{atr.name}}"/>{{atr.value}}</textarea>
        {% else %}
        <input class="sp_input_field" type="text" name="{{atr.name}}" 
            value="{{atr.value}}"/>
        {% endif %}
        </div>
    </div>
    {% endfor %}
    <div style="height: 40px;">
    </div>
</div>
{% endblock %}